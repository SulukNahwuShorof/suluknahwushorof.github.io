<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendaftaran Santri Baru - Metode As-Suluk</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Arab -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
    
    <style>
        .arabic {
            font-family: 'Amiri', serif;
            direction: rtl;
        }
        .loading {
            display: none;
        }
        .loading.active {
            display: inline-block;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-green-50 to-white min-h-screen">

    <!-- Navbar -->
    <nav class="bg-green-800 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <a href="index.html" class="flex items-center space-x-2 hover:text-green-200 transition">
                    <span class="text-2xl">‚Üê</span>
                    <span class="font-bold">Kembali ke Beranda</span>
                </a>
                <div class="flex items-center bg-green-700 px-4 py-2 rounded-lg border-l-4 border-yellow-400">
                    <span class="font-bold">AS SULUK</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Form Pendaftaran -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
            
            <!-- Header Form -->
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-green-800 mb-2">üìã Formulir Pendaftaran</h1>
                <h2 class="text-xl text-gray-600" id="tahunDisplay">Santri Baru 2026 / 1447 H</h2>
                <p class="text-green-600 mt-2 arabic">ÿ®ÿ≥ŸÖ ÿßŸÑŸÑŸá ÿßŸÑÿ±ÿ≠ŸÖŸÜ ÿßŸÑÿ±ÿ≠ŸäŸÖ</p>
            </div>

            <!-- Form -->
            <form id="formDaftar" onsubmit="kirimData(event)">
                <!-- Data Pribadi -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üìå Data Pribadi</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap <span class="text-red-500">*</span></label>
                            <input type="text" id="nama" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Nama lengkap calon santri">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nomor Kartu Keluarga (KK) <span class="text-red-500">*</span></label>
                            <input type="text" id="no_kk" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan nomor KK (16 digit)" maxlength="16">
                            <p class="text-xs text-gray-500 mt-1">Nomor KK yang tercantum di kartu keluarga</p>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tempat Lahir <span class="text-red-500">*</span></label>
                            <input type="text" id="tempat_lahir" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Tempat lahir">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Tanggal Lahir <span class="text-red-500">*</span></label>
                            <input type="date" id="tgl_lahir" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Jenis Kelamin <span class="text-red-500">*</span></label>
                            <select id="jk" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                <option value="">Pilih Jenis Kelamin</option>
                                <option value="Laki-laki">Laki-laki</option>
                                <option value="Perempuan">Perempuan</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Alamat -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üè† Alamat Lengkap</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Alamat <span class="text-red-500">*</span></label>
                            <textarea id="alamat" rows="3" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Alamat lengkap (Jalan, RT/RW, Desa/Kelurahan)"></textarea>
                        </div>
                        
                        <!-- Provinsi Dropdown -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Provinsi <span class="text-red-500">*</span></label>
                            <select id="provinsi" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                <option value="">-- Pilih Provinsi --</option>
                            </select>
                        </div>
                        
                        <!-- Kabupaten/Kota Dropdown -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Kabupaten/Kota <span class="text-red-500">*</span></label>
                            <select id="kota" required disabled class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-100">
                                <option value="">-- Pilih Provinsi Dulu --</option>
                            </select>
                        </div>
                        
                        <!-- Kecamatan Dropdown -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Kecamatan <span class="text-red-500">*</span></label>
                            <select id="kecamatan" required disabled class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-100">
                                <option value="">-- Pilih Kabupaten Dulu --</option>
                            </select>
                        </div>
                        
                        <!-- Kelurahan/Desa Dropdown -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Kelurahan/Desa <span class="text-red-500">*</span></label>
                            <select id="kelurahan" required disabled class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-100">
                                <option value="">-- Pilih Kecamatan Dulu --</option>
                            </select>
                        </div>
                        
                        <!-- Kode Pos -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Kode Pos</label>
                            <input type="text" id="kodepos" readonly class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100" placeholder="Akan terisi otomatis">
                        </div>
                    </div>
                </div>

                <!-- Kontak -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üìû Kontak</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">No. WhatsApp Aktif <span class="text-red-500">*</span></label>
                            <input type="tel" id="wa" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="6281234567890">
                            <p class="text-xs text-gray-500 mt-1">Gunakan format 62, contoh: 6281234567890</p>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" id="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="nama@email.com">
                        </div>
                    </div>
                </div>

                <!-- Pendidikan -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üéì Pendidikan Terakhir</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Jenjang <span class="text-red-500">*</span></label>
                            <select id="pendidikan" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                                <option value="">Pilih Jenjang</option>
                                <option value="SD/MI">SD/MI</option>
                                <option value="SMP/MTs">SMP/MTs</option>
                                <option value="SMA/MA">SMA/MA</option>
                                <option value="Pondok Pesantren">Pondok Pesantren</option>
                                <option value="Lainnya">Lainnya</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Sekolah/Instansi <span class="text-red-500">*</span></label>
                            <input type="text" id="nama_sekolah" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Nama sekolah/pondok">
                        </div>
                    </div>
                </div>

                <!-- Data Orang Tua -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üë®‚Äçüë©‚Äçüëß Data Orang Tua/Wali</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Ayah <span class="text-red-500">*</span></label>
                            <input type="text" id="nama_ayah" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Ibu <span class="text-red-500">*</span></label>
                            <input type="text" id="nama_ibu" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Wali <span class="text-red-500">*</span></label>
                            <input type="text" id="nama_wali" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">No. WA Orang Tua/Wali <span class="text-red-500">*</span></label>
                            <input type="tel" id="wa_ortu" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="6281234567890">
                        </div>
                    </div>
                </div>

                <!-- Program Pilihan -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üéØ Program Pilihan</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <label class="flex items-center space-x-2 p-3 border rounded-lg hover:bg-green-50 cursor-pointer">
                            <input type="radio" name="program" value="Ibtida" checked class="text-green-600">
                            <span>Ibtida (Pemula)</span>
                        </label>
                        <label class="flex items-center space-x-2 p-3 border rounded-lg hover:bg-green-50 cursor-pointer">
                            <input type="radio" name="program" value="Wustho" class="text-green-600">
                            <span>Wustho (Menengah)</span>
                        </label>
                        <label class="flex items-center space-x-2 p-3 border rounded-lg hover:bg-green-50 cursor-pointer">
                            <input type="radio" name="program" value="Ulya" class="text-green-600">
                            <span>Ulya (Lanjutan)</span>
                        </label>
                    </div>
                </div>

                <!-- Informasi Tambahan -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-green-700 mb-4 pb-2 border-b-2 border-green-200">üí¨ Informasi Tambahan</h3>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Motivasi/Semangat (Opsional)</label>
                        <textarea id="motivasi" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Ceritakan semangat Anda ingin belajar Nahwu & Sharaf..."></textarea>
                    </div>
                </div>

                <!-- Tombol Submit -->
                <div class="flex flex-col sm:flex-row gap-4 mt-8">
                    <button type="submit" id="btnKirim" class="flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-lg font-bold text-lg hover:from-green-700 hover:to-green-800 transition shadow-lg transform hover:scale-105 duration-300">
                        <span class="inline-block" id="textBtn">üì§ Kirim Pendaftaran</span>
                        <span class="loading" id="loading">‚è≥ Mengirim...</span>
                    </button>
                    <button type="button" onclick="history.back()" class="flex-1 border-2 border-gray-300 px-8 py-4 rounded-lg font-bold text-lg hover:bg-gray-100 transition">
                        Batal
                    </button>
                </div>

                <p class="text-xs text-gray-400 text-center mt-4">
                    <span class="text-red-500">*</span> Data wajib diisi. Data akan dikirim langsung ke admin via WhatsApp.
                </p>
            </form>
        </div>
    </div>

    <!-- INFO KONTAK -->
    <div class="max-w-4xl mx-auto px-4 mt-8">
        <div class="bg-green-50 rounded-2xl p-6 border border-green-200">
            <h3 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                <span class="text-2xl mr-2">üìû</span> 
                Butuh Bantuan? Hubungi Kami
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- WhatsApp -->
                <a href="https://wa.me/628981820101?text=Assalamu'alaikum%20saya%20ingin%20bertanya%20tentang%20pendaftaran" target="_blank" class="flex items-center gap-3 p-4 bg-white rounded-xl hover:shadow-md transition border border-green-100">
                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-2xl">üì±</div>
                    <div>
                        <p class="font-semibold text-gray-800">WhatsApp Admin</p>
                        <p class="text-sm text-gray-500">+62 898-1820-101</p>
                        <p class="text-xs text-green-600 mt-1">Klik untuk chat</p>
                    </div>
                </a>
                
                <!-- Email -->
                <a href="mailto:ppmatholibasuluk02@gmail.com?subject=Pertanyaan%20Pendaftaran%20Santri" class="flex items-center gap-3 p-4 bg-white rounded-xl hover:shadow-md transition border border-green-100">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-2xl">üìß</div>
                    <div>
                        <p class="font-semibold text-gray-800">Email</p>
                        <p class="text-sm text-gray-500">ppmatholibasuluk02</p>
                        <p class="text-xs text-blue-600 mt-1">Klik untuk email</p>
                    </div>
                </a>
            </div>
            
            <!-- Jam Operasional -->
            <div class="mt-4 text-sm text-gray-600 border-t border-green-200 pt-4">
                <p class="flex items-center gap-2">
                    <span class="text-green-600">‚è∞</span> 
                    Respon cepat: Senin - Jumat (08.00 - 16.00 WIB)
                </p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-12 py-6">
        <div class="max-w-6xl mx-auto px-4 text-center text-gray-400 text-sm">
            <p>¬© 2026 Metode As-Suluk - Pondok Pesantren Matholi'ul Basuluk</p>
            <p class="mt-2">Kaliwadas, Sumber, Cirebon, Jawa Barat</p>
        </div>
    </footer>

    <!-- Script Utama -->
    <script>
        // Fungsi kirim data
        function kirimData(event) {
            event.preventDefault();
            
            // Tampilkan loading
            document.getElementById('textBtn').style.display = 'none';
            document.getElementById('loading').style.display = 'inline-block';
            document.getElementById('btnKirim').disabled = true;
            
            try {
                // Ambil data form
                const nama = document.getElementById('nama').value;
                const tempat_lahir = document.getElementById('tempat_lahir').value;
                const no_kk = document.getElementById('no_kk').value;
                const tgl_lahir = document.getElementById('tgl_lahir').value;
                const jk = document.getElementById('jk').value;
                const alamat = document.getElementById('alamat').value;
                
                // Data wilayah
                const provSelect = document.getElementById('provinsi');
                const provinsi = provSelect.options[provSelect.selectedIndex]?.text || '';
                
                const kotaSelect = document.getElementById('kota');
                const kota = kotaSelect.options[kotaSelect.selectedIndex]?.text || '';
                
                const kecSelect = document.getElementById('kecamatan');
                const kecamatan = kecSelect.options[kecSelect.selectedIndex]?.text || '';
                
                const kelSelect = document.getElementById('kelurahan');
                const kelurahan = kelSelect.options[kelSelect.selectedIndex]?.text || '';
                
                const kodepos = document.getElementById('kodepos').value || '-';
                
                // Kontak
                const wa = document.getElementById('wa').value;
                const email = document.getElementById('email').value || '-';
                
                // Pendidikan
                const pendidikan = document.getElementById('pendidikan').value;
                const nama_sekolah = document.getElementById('nama_sekolah').value;
                
                // Orang tua
                const nama_ayah = document.getElementById('nama_ayah').value;
                const nama_ibu = document.getElementById('nama_ibu').value;
                const nama_wali = document.getElementById('nama_wali').value;
                const wa_ortu = document.getElementById('wa_ortu').value;
                
                // Program
                const programRadio = document.querySelector('input[name="program"]:checked');
                const program = programRadio ? programRadio.value : 'Ibtida';
                
                // Motivasi
                const motivasi = document.getElementById('motivasi').value || '-';
                
                // Format pesan
                const pesan = `*üìã PENDAFTARAN SANTRI BARU METODE AS-SULUK 2026*
                
*DATA PRIBADI*
Nama Lengkap: ${nama}
Nomor KK: ${no_kk}
Tempat, Tgl Lahir: ${tempat_lahir}, ${tgl_lahir}
Jenis Kelamin: ${jk}

*ALAMAT LENGKAP*
${alamat}
Kelurahan: ${kelurahan}
Kecamatan: ${kecamatan}
Kota: ${kota}
Provinsi: ${provinsi}
Kode Pos: ${kodepos}

*KONTAK*
No. WA: ${wa}
Email: ${email}

*PENDIDIKAN TERAKHIR*
${pendidikan} - ${nama_sekolah}

*PROGRAM DIPILIH*
${program}

*DATA ORANG TUA/WALI*
Ayah: ${nama_ayah}
Ibu: ${nama_ibu}
Wali: ${nama_wali}
WA Orang Tua: ${wa_ortu}

*MOTIVASI*
${motivasi}

*_Mohon konfirmasi pendaftaran. Jazakumullah khairan._*`;
                
                // Nomor admin
                const nomorAdmin = '628981820101';
                
                // Kirim ke WhatsApp
                window.open(`https://wa.me/${nomorAdmin}?text=${encodeURIComponent(pesan)}`, '_blank');
                
                // Kembalikan tombol
                document.getElementById('textBtn').style.display = 'inline-block';
                document.getElementById('loading').style.display = 'none';
                document.getElementById('btnKirim').disabled = false;
                
                // Reset form
                document.getElementById('formDaftar').reset();
                
                // Alert sukses
                alert('‚úÖ Pendaftaran berhasil dikirim! Silakan cek WhatsApp admin.');
                
            } catch (error) {
                console.error('Error:', error);
                alert('Terjadi kesalahan: ' + error.message);
                
                document.getElementById('textBtn').style.display = 'inline-block';
                document.getElementById('loading').style.display = 'none';
                document.getElementById('btnKirim').disabled = false;
            }
        }
    </script>

    <!-- Script Wilayah Indonesia -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load provinsi
            fetch('https://ihsaninh.github.io/wilayah-indonesia/provinces.json')
                .then(response => response.json())
                .then(provinces => {
                    const selectProvinsi = document.getElementById('provinsi');
                    provinces.forEach(prov => {
                        const option = document.createElement('option');
                        option.value = prov.id;
                        option.textContent = prov.value;
                        selectProvinsi.appendChild(option);
                    });
                })
                .catch(error => console.error('Error loading provinces:', error));

            // Event listener provinsi
            document.getElementById('provinsi').addEventListener('change', function() {
                const provinceId = this.value;
                const selectKota = document.getElementById('kota');
                const selectKecamatan = document.getElementById('kecamatan');
                const selectKelurahan = document.getElementById('kelurahan');
                const inputKodepos = document.getElementById('kodepos');
                
                selectKota.innerHTML = '<option value="">-- Pilih Kabupaten/Kota --</option>';
                selectKecamatan.innerHTML = '<option value="">-- Pilih Kecamatan --</option>';
                selectKelurahan.innerHTML = '<option value="">-- Pilih Kelurahan --</option>';
                selectKecamatan.disabled = true;
                selectKelurahan.disabled = true;
                inputKodepos.value = '';
                
                if (!provinceId) {
                    selectKota.disabled = true;
                    return;
                }
                
                selectKota.disabled = false;
                selectKota.classList.remove('bg-gray-100');
                
                fetch(`https://ihsaninh.github.io/wilayah-indonesia/${provinceId}/regencies.json`)
                    .then(response => response.json())
                    .then(regencies => {
                        regencies.forEach(reg => {
                            const option = document.createElement('option');
                            option.value = reg.id;
                            option.textContent = reg.type + ' ' + reg.value;
                            selectKota.appendChild(option);
                        });
                    })
                    .catch(error => {
                        console.error('Error loading regencies:', error);
                        selectKota.innerHTML = '<option value="">Error loading data</option>';
                    });
            });

            // Event listener kota
            document.getElementById('kota').addEventListener('change', function() {
                const provinceId = document.getElementById('provinsi').value;
                const regencyId = this.value;
                const selectKecamatan = document.getElementById('kecamatan');
                const selectKelurahan = document.getElementById('kelurahan');
                const inputKodepos = document.getElementById('kodepos');
                
                selectKecamatan.innerHTML = '<option value="">-- Pilih Kecamatan --</option>';
                selectKelurahan.innerHTML = '<option value="">-- Pilih Kelurahan --</option>';
                selectKelurahan.disabled = true;
                inputKodepos.value = '';
                
                if (!regencyId) {
                    selectKecamatan.disabled = true;
                    return;
                }
                
                selectKecamatan.disabled = false;
                selectKecamatan.classList.remove('bg-gray-100');
                
                fetch(`https://ihsaninh.github.io/wilayah-indonesia/${provinceId}/${regencyId}/district.json`)
                    .then(response => response.json())
                    .then(districts => {
                        districts.forEach(dist => {
                            const option = document.createElement('option');
                            option.value = dist.id;
                            option.textContent = dist.value;
                            selectKecamatan.appendChild(option);
                        });
                    })
                    .catch(error => {
                        console.error('Error loading districts:', error);
                        selectKecamatan.innerHTML = '<option value="">Error loading data</option>';
                    });
            });

            // Event listener kecamatan
            document.getElementById('kecamatan').addEventListener('change', function() {
                const provinceId = document.getElementById('provinsi').value;
                const regencyId = document.getElementById('kota').value;
                const districtId = this.value;
                const selectKelurahan = document.getElementById('kelurahan');
                const inputKodepos = document.getElementById('kodepos');
                
                selectKelurahan.innerHTML = '<option value="">-- Pilih Kelurahan --</option>';
                inputKodepos.value = '';
                
                if (!districtId) {
                    selectKelurahan.disabled = true;
                    return;
                }
                
                selectKelurahan.disabled = false;
                selectKelurahan.classList.remove('bg-gray-100');
                
                fetch(`https://ihsaninh.github.io/wilayah-indonesia/${provinceId}/${regencyId}/${districtId}/subdistrict.json`)
                    .then(response => response.json())
                    .then(subdistricts => {
                        subdistricts.forEach(sub => {
                            const option = document.createElement('option');
                            option.value = sub.id;
                            option.textContent = sub.value;
                            option.setAttribute('data-postal', sub.postal_code);
                            selectKelurahan.appendChild(option);
                        });
                    })
                    .catch(error => {
                        console.error('Error loading subdistricts:', error);
                        selectKelurahan.innerHTML = '<option value="">Error loading data</option>';
                    });
            });

            // Event listener kelurahan
            document.getElementById('kelurahan').addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                const postalCode = selectedOption.getAttribute('data-postal');
                document.getElementById('kodepos').value = postalCode || '';
            });
        });
    </script>

    <!-- Script Tahun Otomatis -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tahunMasehi = new Date().getFullYear();
            const tahunHijriah = Math.floor((tahunMasehi - 622) * (33/32));
            document.getElementById('tahunDisplay').innerHTML = `Santri Baru ${tahunMasehi} / ${tahunHijriah} H`;
        });
    </script>

</body>
</html>